## 4.2 ä½¿ç”¨ Beautiful Soup

å‰é¢ä»‹ç»äº†æ­£åˆ™è¡¨è¾¾å¼çš„ç›¸å…³ç”¨æ³•ï¼Œä½†æ˜¯ä¸€æ—¦æ­£åˆ™è¡¨è¾¾å¼å†™çš„æœ‰é—®é¢˜ï¼Œå¾—åˆ°çš„å¯èƒ½å°±ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœäº†ã€‚è€Œä¸”å¯¹äºä¸€ä¸ªç½‘é¡µæ¥è¯´ï¼Œéƒ½æœ‰ä¸€å®šçš„ç‰¹æ®Šç»“æ„å’Œå±‚çº§å…³ç³»ï¼Œè€Œä¸”å¾ˆå¤šèŠ‚ç‚¹éƒ½æœ‰ id æˆ– class æ¥ä½œåŒºåˆ†ï¼Œæ‰€ä»¥å€ŸåŠ©å®ƒä»¬çš„ç»“æ„å’Œå±æ€§æ¥æå–ä¸ä¹Ÿå¯ä»¥å—ï¼Ÿ

è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°±æ¥ä»‹ç»ä¸€ä¸ªå¼ºå¤§çš„è§£æå·¥å…· Beautiful Soupï¼Œå®ƒå€ŸåŠ©ç½‘é¡µçš„ç»“æ„å’Œå±æ€§ç­‰ç‰¹æ€§æ¥è§£æç½‘é¡µã€‚æœ‰äº†å®ƒï¼Œæˆ‘ä»¬ä¸ç”¨å†å»å†™ä¸€äº›å¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªéœ€è¦ç®€å•çš„å‡ æ¡è¯­å¥ï¼Œå°±å¯ä»¥å®Œæˆç½‘é¡µä¸­æŸä¸ªå…ƒç´ çš„æå–ã€‚

åºŸè¯ä¸å¤šè¯´ï¼Œæ¥ä¸‹æ¥å°±æ¥æ„Ÿå—ä¸€ä¸‹ Beautiful Soup çš„å¼ºå¤§ä¹‹å¤„å§ã€‚

### 1. Beautiful Soup ç®€ä»‹

ç®€å•æ¥è¯´ï¼ŒBeautifulSoup å°±æ˜¯ Python çš„ä¸€ä¸ª HTML æˆ– XML çš„è§£æåº“ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥æ–¹ä¾¿åœ°ä»ç½‘é¡µä¸­æå–æ•°æ®ï¼Œå®˜æ–¹çš„è§£é‡Šå¦‚ä¸‹ï¼š

> BeautifulSoup æä¾›ä¸€äº›ç®€å•çš„ã€Python å¼çš„å‡½æ•°ç”¨æ¥å¤„ç†å¯¼èˆªã€æœç´¢ã€ä¿®æ”¹åˆ†ææ ‘ç­‰åŠŸèƒ½ã€‚å®ƒæ˜¯ä¸€ä¸ªå·¥å…·ç®±ï¼Œé€šè¿‡è§£ææ–‡æ¡£ä¸ºç”¨æˆ·æä¾›éœ€è¦æŠ“å–çš„æ•°æ®ï¼Œå› ä¸ºç®€å•ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤šå°‘ä»£ç å°±å¯ä»¥å†™å‡ºä¸€ä¸ªå®Œæ•´çš„åº”ç”¨ç¨‹åºã€‚
BeautifulSoup è‡ªåŠ¨å°†è¾“å…¥æ–‡æ¡£è½¬æ¢ä¸º Unicode ç¼–ç ï¼Œè¾“å‡ºæ–‡æ¡£è½¬æ¢ä¸º utf-8 ç¼–ç ã€‚ä½ ä¸éœ€è¦è€ƒè™‘ç¼–ç æ–¹å¼ï¼Œé™¤éæ–‡æ¡£æ²¡æœ‰æŒ‡å®šä¸€ä¸ªç¼–ç æ–¹å¼ï¼Œè¿™æ—¶ä½ ä»…ä»…éœ€è¦è¯´æ˜ä¸€ä¸‹åŸå§‹ç¼–ç æ–¹å¼å°±å¯ä»¥äº†ã€‚
BeautifulSoup å·²æˆä¸ºå’Œ lxmlã€html5lib ä¸€æ ·å‡ºè‰²çš„ Python è§£é‡Šå™¨ï¼Œä¸ºç”¨æˆ·çµæ´»åœ°æä¾›ä¸åŒçš„è§£æç­–ç•¥æˆ–å¼ºåŠ²çš„é€Ÿåº¦ã€‚

æ‰€ä»¥è¯´ï¼Œåˆ©ç”¨å®ƒå¯ä»¥çœå»å¾ˆå¤šçƒ¦ççš„æå–å·¥ä½œï¼Œæé«˜äº†è§£ææ•ˆç‡ã€‚

### 2. å‡†å¤‡å·¥ä½œ

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å·²ç»æ­£ç¡®å®‰è£…å¥½äº† Beautiful Soup å’Œ lxmlï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œå¯ä»¥å‚è€ƒç¬¬ 1 ç« çš„å†…å®¹ã€‚

### 3. è§£æå™¨

Beautiful Soup åœ¨è§£ææ—¶å®é™…ä¸Šä¾èµ–è§£æå™¨ï¼Œå®ƒé™¤äº†æ”¯æŒ Python æ ‡å‡†åº“ä¸­çš„ HTML è§£æå™¨å¤–ï¼Œè¿˜**æ”¯æŒä¸€äº›ç¬¬ä¸‰æ–¹è§£æå™¨ï¼ˆæ¯”å¦‚ lxmlï¼‰**ã€‚è¡¨ 4-3 åˆ—å‡ºäº† Beautiful Soup æ”¯æŒçš„è§£æå™¨ã€‚

è¡¨ 4-3ã€€Beautiful Soup æ”¯æŒçš„è§£æå™¨


|  è§£æå™¨	| ä½¿ç”¨æ–¹æ³• | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|:---: | :---: | :---: | :---: |
| Python æ ‡å‡†åº“ |	BeautifulSoup(markup, "html.parser")	| Python çš„å†…ç½®æ ‡å‡†åº“ã€æ‰§è¡Œé€Ÿåº¦é€‚ä¸­ ã€æ–‡æ¡£å®¹é”™èƒ½åŠ›å¼º | Python 2.7.3 or 3.2.2) å‰çš„ç‰ˆæœ¬ä¸­æ–‡å®¹é”™èƒ½åŠ›å·® |
| LXML HTML è§£æå™¨	| BeautifulSoup(markup, "lxml")	| é€Ÿåº¦å¿«ã€æ–‡æ¡£å®¹é”™èƒ½åŠ›å¼º | éœ€è¦å®‰è£… C è¯­è¨€åº“ |
| LXML XML è§£æå™¨	| BeautifulSoup(markup, "xml") | é€Ÿåº¦å¿«ã€å”¯ä¸€æ”¯æŒ XML çš„è§£æå™¨ | éœ€è¦å®‰è£… C è¯­è¨€åº“ |
| html5lib	| BeautifulSoup(markup, "html5lib")	 | æœ€å¥½çš„å®¹é”™æ€§ã€ä»¥æµè§ˆå™¨çš„æ–¹å¼è§£ææ–‡æ¡£ã€ç”Ÿæˆ HTML5 æ ¼å¼çš„æ–‡æ¡£ | é€Ÿåº¦æ…¢ã€ä¸ä¾èµ–å¤–éƒ¨æ‰©å±• |

é€šè¿‡ä»¥ä¸Šå¯¹æ¯”å¯ä»¥çœ‹å‡ºï¼Œlxml è§£æå™¨æœ‰è§£æ HTML å’Œ XML çš„åŠŸèƒ½ï¼Œè€Œä¸”é€Ÿåº¦å¿«ï¼Œå®¹é”™èƒ½åŠ›å¼ºï¼Œæ‰€ä»¥æ¨èä½¿ç”¨å®ƒã€‚

å¦‚æœä½¿ç”¨ lxmlï¼Œé‚£ä¹ˆåœ¨åˆå§‹åŒ– Beautiful Soup æ—¶ï¼Œå¯ä»¥æŠŠç¬¬äºŒä¸ªå‚æ•°æ”¹ä¸º lxml å³å¯ï¼š

```python
from bs4 import BeautifulSoup
soup = BeautifulSoup('<p>Hello</p>', 'lxml')
print(soup.p.string)
```

åœ¨åé¢ï¼ŒBeautiful Soup çš„ç”¨æ³•å®ä¾‹ä¹Ÿç»Ÿä¸€ç”¨è¿™ä¸ªè§£æå™¨æ¥æ¼”ç¤ºã€‚

### 4. åŸºæœ¬ä½¿ç”¨

ä¸‹é¢é¦–å…ˆç”¨å®ä¾‹æ¥çœ‹çœ‹ Beautiful Soup çš„åŸºæœ¬ç”¨æ³•ï¼š

```python
html = """
<html><head><title>The Dormouse's story</title></head>
<body>
<p class="title" name="dromouse"><b>The Dormouse's story</b></p>
<p class="story">Once upon a time there were three little sisters; and their names were
<a href="http://example.com/elsie" class="sister" id="link1"><!-- Elsie --></a>,
<a href="http://example.com/lacie" class="sister" id="link2">Lacie</a> and
<a href="http://example.com/tillie" class="sister" id="link3">Tillie</a>;
and they lived at the bottom of a well.</p>
<p class="story">...</p>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.prettify())
print(soup.title.string)
```
è¿è¡Œç»“æœï¼š
```html
<html>
 <head>
  <title>
   The Dormouse's story
  </title>
 </head>
 <body>
  <p class="title" name="dromouse">
   <b>
    The Dormouse's story
   </b>
  </p>
  <p class="story">
   Once upon a time there were three little sisters; and their names were
   <a class="sister" href="http://example.com/elsie" id="link1">
    <!-- Elsie -->
   </a>
   ,
   <a class="sister" href="http://example.com/lacie" id="link2">
    Lacie
   </a>
   and
   <a class="sister" href="http://example.com/tillie" id="link3">
    Tillie
   </a>
   ;
and they lived at the bottom of a well.
  </p>
  <p class="story">
   ...
  </p>
 </body>
</html>
The Dormouse's story
```

è¿™é‡Œé¦–å…ˆå£°æ˜å˜é‡ htmlï¼Œå®ƒæ˜¯ä¸€ä¸ª HTML å­—ç¬¦ä¸²ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„ HTML å­—ç¬¦ä¸²ï¼Œå› ä¸º body å’Œ html èŠ‚ç‚¹éƒ½æ²¡æœ‰é—­åˆã€‚æ¥ç€ï¼Œæˆ‘ä»¬å°†å®ƒå½“ä½œç¬¬ä¸€ä¸ªå‚æ•°ä¼ ç»™ BeautifulSoup å¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºè§£æå™¨çš„ç±»å‹ï¼ˆè¿™é‡Œä½¿ç”¨ lxmlï¼‰ï¼Œæ­¤æ—¶å°±å®Œæˆäº† BeaufulSoup å¯¹è±¡çš„åˆå§‹åŒ–ã€‚ç„¶åï¼Œå°†è¿™ä¸ªå¯¹è±¡èµ‹å€¼ç»™ soup å˜é‡ã€‚

æ¥ä¸‹æ¥ï¼Œå°±å¯ä»¥è°ƒç”¨ soup çš„å„ä¸ªæ–¹æ³•å’Œå±æ€§è§£æè¿™ä¸² HTML ä»£ç äº†ã€‚

é¦–å…ˆï¼Œè°ƒç”¨ **prettify() æ–¹æ³•**ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥**æŠŠè¦è§£æçš„å­—ç¬¦ä¸²ä»¥æ ‡å‡†çš„ç¼©è¿›æ ¼å¼è¾“å‡º**ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¾“å‡ºç»“æœé‡Œé¢åŒ…å« body å’Œ html èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºä¸æ ‡å‡†çš„ HTML å­—ç¬¦ä¸² BeautifulSoupï¼Œå¯ä»¥**è‡ªåŠ¨æ›´æ­£æ ¼å¼**ã€‚è¿™ä¸€æ­¥ä¸æ˜¯ç”± prettify() æ–¹æ³•åšçš„ï¼Œè€Œæ˜¯åœ¨åˆå§‹åŒ– BeautifulSoup æ—¶å°±å®Œæˆäº†ã€‚

ç„¶åè°ƒç”¨ soup.title.stringï¼Œè¿™å®é™…ä¸Šæ˜¯è¾“å‡º HTML ä¸­ title èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ã€‚æ‰€ä»¥ï¼Œsoup.title å¯ä»¥é€‰å‡º HTML ä¸­çš„ title èŠ‚ç‚¹ï¼Œå†**è°ƒç”¨ string å±æ€§å°±å¯ä»¥å¾—åˆ°é‡Œé¢çš„æ–‡æœ¬**äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•è°ƒç”¨å‡ ä¸ªå±æ€§å®Œæˆæ–‡æœ¬æå–ï¼Œè¿™æ˜¯ä¸æ˜¯éå¸¸æ–¹ä¾¿ï¼Ÿ


### 5. èŠ‚ç‚¹/å±æ€§é€‰æ‹©å™¨

ç›´æ¥è°ƒç”¨èŠ‚ç‚¹çš„åç§°å°±å¯ä»¥é€‰æ‹©èŠ‚ç‚¹å…ƒç´ ï¼Œå†è°ƒç”¨ string å±æ€§å°±å¯ä»¥å¾—åˆ°èŠ‚ç‚¹å†…çš„æ–‡æœ¬äº†ï¼Œè¿™ç§**é€‰æ‹©æ–¹å¼é€Ÿåº¦éå¸¸å¿«**ã€‚å¦‚æœå•ä¸ªèŠ‚ç‚¹ç»“æ„å±‚æ¬¡éå¸¸æ¸…æ™°ï¼Œå¯ä»¥é€‰ç”¨è¿™ç§æ–¹å¼æ¥è§£æã€‚

#### é€‰æ‹©å…ƒç´ 

ä¸‹é¢å†ç”¨ä¸€ä¸ªä¾‹å­è¯¦ç»†è¯´æ˜é€‰æ‹©å…ƒç´ çš„æ–¹æ³•ï¼š

```python
html = """
<html><head><title>The Dormouse's story</title></head>
<body>
<p class="title" name="dromouse"><b>The Dormouse's story</b></p>
<p class="story">Once upon a time there were three little sisters; and their names were
<a href="http://example.com/elsie" class="sister" id="link1"><!-- Elsie --></a>,
<a href="http://example.com/lacie" class="sister" id="link2">Lacie</a> and
<a href="http://example.com/tillie" class="sister" id="link3">Tillie</a>;
and they lived at the bottom of a well.</p>
<p class="story">...</p>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.title)
print(type(soup.title))
print(soup.title.string)
print(soup.head)
print(soup.p)
```
è¿è¡Œç»“æœï¼š
```html
<title>The Dormouse's story</title>
<class 'bs4.element.Tag'>
The Dormouse's story
<head><title>The Dormouse's story</title></head>
<p class="title" name="dromouse"><b>The Dormouse's story</b></p>
```

è¿™é‡Œä¾ç„¶é€‰ç”¨åˆšæ‰çš„ HTML ä»£ç ï¼Œé¦–å…ˆæ‰“å°è¾“å‡º title èŠ‚ç‚¹çš„é€‰æ‹©ç»“æœï¼Œè¾“å‡ºç»“æœæ­£æ˜¯ title èŠ‚ç‚¹åŠ é‡Œé¢çš„æ–‡å­—å†…å®¹ã€‚æ¥ä¸‹æ¥ï¼Œè¾“å‡ºå®ƒçš„ç±»å‹ï¼Œæ˜¯ bs4.element.Tag ç±»å‹ï¼Œè¿™æ˜¯ Beautiful Soup ä¸­ä¸€ä¸ªé‡è¦çš„æ•°æ®ç»“æ„ã€‚ç»è¿‡é€‰æ‹©å™¨é€‰æ‹©åï¼Œé€‰æ‹©ç»“æœéƒ½æ˜¯è¿™ç§ Tag ç±»å‹ã€‚**Tag å…·æœ‰ä¸€äº›å±æ€§ï¼Œæ¯”å¦‚ string å±æ€§ï¼Œè°ƒç”¨è¯¥å±æ€§ï¼Œå¯ä»¥å¾—åˆ°èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥çš„è¾“å‡ºç»“æœæ­£æ˜¯èŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ã€‚**

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆå°è¯•é€‰æ‹©äº† head èŠ‚ç‚¹ï¼Œç»“æœä¹Ÿæ˜¯èŠ‚ç‚¹åŠ å…¶å†…éƒ¨çš„æ‰€æœ‰å†…å®¹ã€‚æœ€åï¼Œé€‰æ‹©äº† p èŠ‚ç‚¹ã€‚ä¸è¿‡è¿™æ¬¡æƒ…å†µæ¯”è¾ƒç‰¹æ®Šï¼Œæˆ‘ä»¬å‘ç°ç»“æœæ˜¯ç¬¬ä¸€ä¸ª p èŠ‚ç‚¹çš„å†…å®¹ï¼Œåé¢çš„å‡ ä¸ª p èŠ‚ç‚¹å¹¶æ²¡æœ‰é€‰åˆ°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ**å½“æœ‰å¤šä¸ªèŠ‚ç‚¹æ—¶ï¼Œè¿™ç§é€‰æ‹©æ–¹å¼åªä¼šé€‰æ‹©åˆ°ç¬¬ä¸€ä¸ªåŒ¹é…çš„èŠ‚ç‚¹ï¼Œå…¶ä»–çš„åé¢èŠ‚ç‚¹éƒ½ä¼šå¿½ç•¥**ã€‚


#### æå–ä¿¡æ¯

ä¸Šé¢æ¼”ç¤ºäº†è°ƒç”¨ string å±æ€§æ¥è·å–æ–‡æœ¬çš„å€¼ï¼Œé‚£ä¹ˆå¦‚ä½•è·å–èŠ‚ç‚¹å±æ€§çš„å€¼å‘¢ï¼Ÿå¦‚ä½•è·å–èŠ‚ç‚¹åå‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬æ¥ç»Ÿä¸€æ¢³ç†ä¸€ä¸‹ä¿¡æ¯çš„æå–æ–¹å¼ã€‚

##### è·å–åç§°  --.name

å¯ä»¥åˆ©ç”¨ name å±æ€§è·å–èŠ‚ç‚¹çš„åç§°ã€‚è¿™é‡Œè¿˜æ˜¯ä»¥ä¸Šé¢çš„æ–‡æœ¬ä¸ºä¾‹ï¼Œé€‰å– title èŠ‚ç‚¹ï¼Œç„¶åè°ƒç”¨ name å±æ€§å°±å¯ä»¥å¾—åˆ°èŠ‚ç‚¹åç§°ï¼š

```python
print(soup.title.name)
```
è¿è¡Œç»“æœ:
```
title
```

##### è·å–å±æ€§   --.attrs

æ¯ä¸ªèŠ‚ç‚¹å¯èƒ½æœ‰å¤šä¸ªå±æ€§ï¼Œæ¯”å¦‚ id å’Œ class ç­‰ï¼Œé€‰æ‹©è¿™ä¸ªèŠ‚ç‚¹å…ƒç´ åï¼Œå¯ä»¥è°ƒç”¨ attrs è·å–æ‰€æœ‰å±æ€§ï¼š

```python
#æºä»£ç ï¼š<p class="title" name="dromouse"><b>The Dormouse's story</b></p>
print(soup.p.attrs)
print(soup.p.attrs['name'])
```
è¿è¡Œç»“æœï¼š
```python
{'class': ['title'], 'name': 'dromouse'}
dromouse
```

å¯ä»¥çœ‹åˆ°ï¼Œattrs çš„è¿”å›ç»“æœæ˜¯**å­—å…¸å½¢å¼**ï¼Œå®ƒæŠŠé€‰æ‹©çš„èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§å’Œå±æ€§å€¼ç»„åˆæˆä¸€ä¸ªå­—å…¸ã€‚æ¥ä¸‹æ¥ï¼Œå¦‚æœè¦è·å– name å±æ€§ï¼Œå°±ç›¸å½“äºä»å­—å…¸ä¸­è·å–æŸä¸ªé”®å€¼ï¼Œåªéœ€è¦ç”¨ä¸­æ‹¬å·åŠ å±æ€§åå°±å¯ä»¥äº†ã€‚æ¯”å¦‚ï¼Œè¦è·å– name å±æ€§ï¼Œå°±å¯ä»¥é€šè¿‡ attrs['name'] æ¥å¾—åˆ°ã€‚

å…¶å®è¿™æ ·æœ‰ç‚¹çƒ¦çï¼Œè¿˜æœ‰ä¸€ç§æ›´ç®€å•çš„è·å–æ–¹å¼ï¼šå¯ä»¥ä¸ç”¨å†™ attrsï¼Œ**ç›´æ¥åœ¨èŠ‚ç‚¹å…ƒç´ åé¢åŠ ä¸­æ‹¬å·ï¼Œä¼ å…¥å±æ€§åå°±å¯ä»¥è·å–å±æ€§å€¼äº†**ã€‚æ ·ä¾‹å¦‚ä¸‹ï¼š


```python
print(soup.p['name'])
print(soup.p['class'])
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```
dromouse
['title']
```

è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæœ‰çš„è¿”å›ç»“æœæ˜¯å­—ç¬¦ä¸²ï¼Œæœ‰çš„è¿”å›ç»“æœæ˜¯å­—ç¬¦ä¸²ç»„æˆçš„åˆ—è¡¨ã€‚æ¯”å¦‚ï¼Œname å±æ€§çš„å€¼æ˜¯å”¯ä¸€çš„ï¼Œè¿”å›çš„ç»“æœå°±æ˜¯å•ä¸ªå­—ç¬¦ä¸²ã€‚è€Œå¯¹äº classï¼Œä¸€ä¸ªèŠ‚ç‚¹å…ƒç´ å¯èƒ½æœ‰å¤šä¸ª classï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯åˆ—è¡¨ã€‚**åœ¨å®é™…å¤„ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦æ³¨æ„åˆ¤æ–­ç±»å‹ã€‚**

##### è·å–å†…å®¹  --.string

å¯ä»¥åˆ©ç”¨ string å±æ€§è·å–èŠ‚ç‚¹å…ƒç´ åŒ…å«çš„æ–‡æœ¬å†…å®¹ï¼Œæ¯”å¦‚è¦è·å–ç¬¬ä¸€ä¸ª p èŠ‚ç‚¹çš„æ–‡æœ¬ï¼š

```python
print(soup.p.string)
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```
The Dormouse's story
```

å†æ¬¡æ³¨æ„ä¸€ä¸‹ï¼Œè¿™é‡Œé€‰æ‹©åˆ°çš„ p èŠ‚ç‚¹æ˜¯ç¬¬ä¸€ä¸ª p èŠ‚ç‚¹ï¼Œè·å–çš„æ–‡æœ¬ä¹Ÿæ˜¯ç¬¬ä¸€ä¸ª p èŠ‚ç‚¹é‡Œé¢çš„æ–‡æœ¬ã€‚

#### åµŒå¥—é€‰æ‹©  --.xxx.xxx

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æ¯ä¸€ä¸ªè¿”å›ç»“æœéƒ½æ˜¯ bs4.element.Tag ç±»å‹ï¼Œå®ƒåŒæ ·å¯ä»¥ç»§ç»­è°ƒç”¨èŠ‚ç‚¹è¿›è¡Œä¸‹ä¸€æ­¥çš„é€‰æ‹©ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è·å–äº† head èŠ‚ç‚¹å…ƒç´ ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­è°ƒç”¨ head æ¥é€‰å–å…¶å†…éƒ¨çš„ head èŠ‚ç‚¹å…ƒç´ ï¼š


```python
html = """
<html><head><title>The Dormouse's story</title></head>
<body>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.head.title)
print(type(soup.head.title))
print(soup.head.title.string)
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```html
<title>The Dormouse's story</title>
<class 'bs4.element.Tag'>
The Dormouse's story
```

ç¬¬ä¸€è¡Œç»“æœæ˜¯è°ƒç”¨ head ä¹‹åå†æ¬¡è°ƒç”¨ title è€Œé€‰æ‹©çš„ title èŠ‚ç‚¹å…ƒç´ ã€‚ç„¶åæ‰“å°è¾“å‡ºäº†å®ƒçš„ç±»å‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒä»ç„¶æ˜¯ bs4.element.Tag ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨ Tag ç±»å‹çš„åŸºç¡€ä¸Š**å†æ¬¡é€‰æ‹©å¾—åˆ°çš„ä¾ç„¶è¿˜æ˜¯ Tag ç±»å‹ï¼Œæ¯æ¬¡è¿”å›çš„ç»“æœéƒ½ç›¸åŒï¼Œæ‰€ä»¥è¿™æ ·å°±å¯ä»¥åšåµŒå¥—é€‰æ‹©äº†ã€‚**


#### å…³è”é€‰æ‹©

åœ¨åšé€‰æ‹©çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ä¸èƒ½åšåˆ°ä¸€æ­¥å°±é€‰åˆ°æƒ³è¦çš„èŠ‚ç‚¹å…ƒç´ ï¼Œéœ€è¦å…ˆé€‰ä¸­æŸä¸€ä¸ªèŠ‚ç‚¹å…ƒç´ ï¼Œç„¶åä»¥å®ƒä¸ºåŸºå‡†å†é€‰æ‹©å®ƒçš„å­èŠ‚ç‚¹ã€çˆ¶èŠ‚ç‚¹ã€å…„å¼ŸèŠ‚ç‚¹ç­‰ï¼Œè¿™é‡Œå°±æ¥ä»‹ç»å¦‚ä½•é€‰æ‹©è¿™äº›èŠ‚ç‚¹å…ƒç´ ã€‚

##### å­èŠ‚ç‚¹å’Œå­å­™èŠ‚ç‚¹   --.content/ .children /.descendants 

é€‰å–èŠ‚ç‚¹å…ƒç´ ä¹‹åï¼Œå¦‚æœæƒ³è¦è·å–å®ƒçš„ç›´æ¥å­èŠ‚ç‚¹ï¼Œå¯ä»¥è°ƒç”¨ contents å±æ€§ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
html = """
<html>
    <head>
        <title>The Dormouse's story</title>
    </head>
    <body>
        <p class="story">
            Once upon a time there were three little sisters; and their names were
            <a href="http://example.com/elsie" class="sister" id="link1">
                <span>Elsie</span>
            </a>
            <a href="http://example.com/lacie" class="sister" id="link2">Lacie</a> 
            and
            <a href="http://example.com/tillie" class="sister" id="link3">Tillie</a>
            and they lived at the bottom of a well.
        </p>
        <p class="story">...</p>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.p.contents)
```

è¿è¡Œç»“æœå¦‚ä¸‹ï¼š

```python
['\n            Once upon a time there were three little sisters; and their names were\n            ', <a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>, '\n', <a class="sister" href="http://example.com/lacie" id="link2">Lacie</a>, ' \n            and\n            ', <a class="sister" href="http://example.com/tillie" id="link3">Tillie</a>, '\n            and they lived at the bottom of a well.\n        ']
```

å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›ç»“æœæ˜¯pèŠ‚ç‚¹é‡Œé¢çš„æ‰€æœ‰å†…å®¹ï¼Œä¸ºåˆ—è¡¨å½¢å¼ã€‚p èŠ‚ç‚¹é‡Œæ—¢åŒ…å«æ–‡æœ¬ï¼ŒåˆåŒ…å«èŠ‚ç‚¹ï¼Œæœ€åä¼šå°†å®ƒä»¬ä»¥åˆ—è¡¨å½¢å¼ç»Ÿä¸€è¿”å›ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ p èŠ‚ç‚¹çš„ç›´æ¥å­èŠ‚ç‚¹ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ª a èŠ‚ç‚¹é‡Œé¢åŒ…å«ä¸€å±‚ span èŠ‚ç‚¹ï¼Œè¿™ç›¸å½“äºå­™å­èŠ‚ç‚¹äº†ï¼Œä½†æ˜¯è¿”å›ç»“æœå¹¶æ²¡æœ‰å•ç‹¬æŠŠ span èŠ‚ç‚¹é€‰å‡ºæ¥ã€‚æ‰€ä»¥è¯´ï¼Œ**contents å±æ€§å¾—åˆ°çš„ç»“æœæ˜¯ç›´æ¥å­èŠ‚ç‚¹çš„åˆ—è¡¨**ã€‚

åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ children å±æ€§å¾—åˆ°ç›¸åº”çš„ç»“æœï¼š


```python
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.p.children)
for i, child in enumerate(soup.p.children):
    print(i, child)
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```html
<list_iterator object at 0x1064f7dd8>
0 
            Once upon a time there were three little sisters; and their names were
            
1 <a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>
2 

3 <a class="sister" href="http://example.com/lacie" id="link2">Lacie</a>
4  
            and
            
5 <a class="sister" href="http://example.com/tillie" id="link3">Tillie</a>
6 
            and they lived at the bottom of a well.
```

è¿˜æ˜¯åŒæ ·çš„ HTML æ–‡æœ¬ï¼Œè¿™é‡Œè°ƒç”¨äº† children å±æ€§æ¥é€‰æ‹©ï¼Œè¿”å›ç»“æœæ˜¯ç”Ÿæˆå™¨ç±»å‹ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨ for å¾ªç¯è¾“å‡ºç›¸åº”çš„å†…å®¹ã€‚

å¦‚æœè¦**å¾—åˆ°æ‰€æœ‰çš„å­å­™èŠ‚ç‚¹çš„è¯ï¼Œå¯ä»¥è°ƒç”¨ descendants å±æ€§**ï¼š


```python
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.p.descendants)
for i, child in enumerate(soup.p.descendants):
    print(i, child)
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```html
<generator object descendants at 0x10650e678>
0 
            Once upon a time there were three little sisters; and their names were
            
1 <a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>
2 

3 <span>Elsie</span>
4 Elsie
5 

6 

7 <a class="sister" href="http://example.com/lacie" id="link2">Lacie</a>
8 Lacie
9  
            and
            
10 <a class="sister" href="http://example.com/tillie" id="link3">Tillie</a>
11 Tillie
12 
            and they lived at the bottom of a well.
```

æ­¤æ—¶è¿”å›ç»“æœè¿˜æ˜¯ç”Ÿæˆå™¨ã€‚éå†è¾“å‡ºä¸€ä¸‹å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ¬¡çš„è¾“å‡ºç»“æœå°±åŒ…å«äº† span èŠ‚ç‚¹ã€‚descendants ä¼šé€’å½’æŸ¥è¯¢æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œå¾—åˆ°æ‰€æœ‰çš„å­å­™èŠ‚ç‚¹ã€‚

##### çˆ¶èŠ‚ç‚¹å’Œç¥–å…ˆèŠ‚ç‚¹   --.parent

å¦‚æœè¦è·å–æŸä¸ªèŠ‚ç‚¹å…ƒç´ çš„çˆ¶èŠ‚ç‚¹ï¼Œå¯ä»¥è°ƒç”¨ parent å±æ€§ï¼š

```python
html = """
<html>
    <head>
        <title>The Dormouse's story</title>
    </head>
    <body>
        <p class="story">
            Once upon a time there were three little sisters; and their names were
            <a href="http://example.com/elsie" class="sister" id="link1">
                <span>Elsie</span>
            </a>
        </p>
        <p class="story">...</p>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.a.parent)
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```html
<p class="story">
            Once upon a time there were three little sisters; and their names were
            <a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>
</p>
```

è¿™é‡Œæˆ‘ä»¬é€‰æ‹©çš„æ˜¯ç¬¬ä¸€ä¸ª a èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å…ƒç´ ã€‚å¾ˆæ˜æ˜¾ï¼Œå®ƒçš„çˆ¶èŠ‚ç‚¹æ˜¯ p èŠ‚ç‚¹ï¼Œè¾“å‡ºç»“æœä¾¿æ˜¯ p èŠ‚ç‚¹åŠå…¶å†…éƒ¨çš„å†…å®¹ã€‚

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œè¾“å‡ºçš„ä»…ä»…æ˜¯ a èŠ‚ç‚¹çš„ç›´æ¥çˆ¶èŠ‚ç‚¹ï¼Œè€Œæ²¡æœ‰å†å‘å¤–å¯»æ‰¾çˆ¶èŠ‚ç‚¹çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚å¦‚æœæƒ³è·å–æ‰€æœ‰çš„ç¥–å…ˆèŠ‚ç‚¹ï¼Œå¯ä»¥è°ƒç”¨ parents å±æ€§ï¼š


```python
html = """
<html>
    <body>
        <p class="story">
            <a href="http://example.com/elsie" class="sister" id="link1">
                <span>Elsie</span>
            </a>
        </p>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(type(soup.a.parents))
print(list(enumerate(soup.a.parents)))
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```python
<class 'generator'>
[(0, <p class="story">
<a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>
</p>), (1, <body>
<p class="story">
<a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>
</p>
</body>), (2, <html>
<body>
<p class="story">
<a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>
</p>
</body></html>), (3, <html>
<body>
<p class="story">
<a class="sister" href="http://example.com/elsie" id="link1">
<span>Elsie</span>
</a>
</p>
</body></html>)]
```

å¯ä»¥å‘ç°ï¼Œè¿”å›ç»“æœæ˜¯ç”Ÿæˆå™¨ç±»å‹ã€‚è¿™é‡Œç”¨åˆ—è¡¨è¾“å‡ºäº†å®ƒçš„ç´¢å¼•å’Œå†…å®¹ï¼Œè€Œåˆ—è¡¨ä¸­çš„å…ƒç´ å°±æ˜¯ a èŠ‚ç‚¹çš„ç¥–å…ˆèŠ‚ç‚¹ã€‚

##### å…„å¼ŸèŠ‚ç‚¹   -- .next_sibling(s) /. previous_sibling(s) 

ä¸Šé¢è¯´æ˜äº†å­èŠ‚ç‚¹å’Œçˆ¶èŠ‚ç‚¹çš„è·å–æ–¹å¼ï¼Œå¦‚æœè¦è·å–åŒçº§çš„èŠ‚ç‚¹ï¼ˆä¹Ÿå°±æ˜¯å…„å¼ŸèŠ‚ç‚¹ï¼‰ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
html = """
<html>
    <body>
        <p class="story">
            Once upon a time there were three little sisters; and their names were
            <a href="http://example.com/elsie" class="sister" id="link1">
                <span>Elsie</span>
            </a>
            Hello
            <a href="http://example.com/lacie" class="sister" id="link2">Lacie</a> 
            and
            <a href="http://example.com/tillie" class="sister" id="link3">Tillie</a>
            and they lived at the bottom of a well.
        </p>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print('Next Sibling', soup.a.next_sibling)
print('Prev Sibling', soup.a.previous_sibling)
print('Next Siblings', list(enumerate(soup.a.next_siblings)))
print('Prev Siblings', list(enumerate(soup.a.previous_siblings)))
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```python
Next Sibling 
            Hello
            
Prev Sibling 
            Once upon a time there were three little sisters; and their names were
            
Next Siblings [(0, '\n            Hello\n            '), (1, <a class="sister" href="http://example.com/lacie" id="link2">Lacie</a>), (2, ' \n            and\n            '), (3, <a class="sister" href="http://example.com/tillie" id="link3">Tillie</a>), (4, '\n            and they lived at the bottom of a well.\n        ')]
Prev Siblings [(0, '\n            Once upon a time there were three little sisters; and their names were\n            ')]
```

å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œè°ƒç”¨äº† 4 ä¸ªå±æ€§ï¼Œå…¶ä¸­ next_sibling å’Œ previous_sibling åˆ†åˆ«è·å–èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå’Œä¸Šä¸€ä¸ªå…„å¼Ÿå…ƒç´ ï¼Œnext_siblings å’Œ previous_siblings åˆ™åˆ†åˆ«è¿”å›åé¢å’Œå‰é¢çš„å…„å¼ŸèŠ‚ç‚¹ã€‚

##### æå–ä¿¡æ¯  -.string/.attrs

å‰é¢è®²è§£äº†å…³è”å…ƒç´ èŠ‚ç‚¹çš„é€‰æ‹©æ–¹æ³•ï¼Œå¦‚æœæƒ³è¦è·å–å®ƒä»¬çš„ä¸€äº›ä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡æœ¬ã€å±æ€§ç­‰ï¼Œä¹Ÿç”¨åŒæ ·çš„æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
html = """
<html>
    <body>
        <p class="story">
            Once upon a time there were three little sisters; and their names were
            <a href="http://example.com/elsie" class="sister" id="link1">Bob</a><a href="http://example.com/lacie" class="sister" id="link2">Lacie</a> 
        </p>
"""
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print('Next Sibling:')
print(type(soup.a.next_sibling))
print(soup.a.next_sibling)
print(soup.a.next_sibling.string)
print('Parent:')
print(type(soup.a.parents))
print(list(soup.a.parents)[0])
print(list(soup.a.parents)[0].attrs['class'])
```
è¿è¡Œç»“æœï¼š
```python
Next Sibling:
<class 'bs4.element.Tag'>
<a class="sister" href="http://example.com/lacie" id="link2">Lacie</a>
Lacie
Parent:
<class 'generator'>
<p class="story">
            Once upon a time there were three little sisters; and their names were
            <a class="sister" href="http://example.com/elsie" id="link1">Bob</a><a class="sister" href="http://example.com/lacie" id="link2">Lacie</a>
</p>
['story']
```

å¦‚æœè¿”å›ç»“æœæ˜¯å•ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥è°ƒç”¨ stringã€attrs ç­‰å±æ€§è·å¾—å…¶æ–‡æœ¬å’Œå±æ€§ï¼›å¦‚æœè¿”å›ç»“æœæ˜¯å¤šä¸ªèŠ‚ç‚¹çš„ç”Ÿæˆå™¨ï¼Œåˆ™å¯ä»¥è½¬ä¸ºåˆ—è¡¨åå–å‡ºæŸä¸ªå…ƒç´ ï¼Œç„¶åå†è°ƒç”¨ stringã€attrs ç­‰å±æ€§è·å–å…¶å¯¹åº”èŠ‚ç‚¹çš„æ–‡æœ¬å’Œå±æ€§ã€‚

### 6. æ–¹æ³•é€‰æ‹©å™¨

å‰é¢æ‰€è®²çš„é€‰æ‹©æ–¹æ³•éƒ½æ˜¯é€šè¿‡å±æ€§æ¥é€‰æ‹©çš„ï¼Œè¿™ç§æ–¹æ³•éå¸¸å¿«ï¼Œä½†æ˜¯å¦‚æœè¿›è¡Œæ¯”è¾ƒå¤æ‚çš„é€‰æ‹©çš„è¯ï¼Œå®ƒå°±æ¯”è¾ƒçƒ¦çï¼Œä¸å¤Ÿçµæ´»äº†ã€‚å¹¸å¥½ï¼ŒBeautiful Soup è¿˜ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€äº›æŸ¥è¯¢æ–¹æ³•ï¼Œæ¯”å¦‚ find_all å’Œ find ç­‰ï¼Œè°ƒç”¨å®ƒä»¬ï¼Œç„¶åä¼ å…¥ç›¸åº”çš„å‚æ•°ï¼Œå°±å¯ä»¥çµæ´»æŸ¥è¯¢äº†ã€‚


#### find_all  --name/attrs/text

find_allï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯æŸ¥è¯¢æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œå¯ä»¥ç»™å®ƒä¼ å…¥ä¸€äº›å±æ€§æˆ–æ–‡æœ¬æ¥å¾—åˆ°ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼ŒåŠŸèƒ½ååˆ†å¼ºå¤§ã€‚

å®ƒçš„ API å¦‚ä¸‹ï¼š

```python
find_all(name , attrs , recursive , text , **kwargs)
```

##### name

æˆ‘ä»¬å¯ä»¥æ ¹æ®èŠ‚ç‚¹åæ¥æŸ¥è¯¢å…ƒç´ ï¼Œä¸‹é¢æˆ‘ä»¬ç”¨ä¸€ä¸ªå®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ï¼š

```python
html='''
<div class="panel">
    <div class="panel-heading">
        <h4>Hello</h4>
    </div>
    <div class="panel-body">
        <ul class="list" id="list-1">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
            <li class="element">Jay</li>
        </ul>
        <ul class="list list-small" id="list-2">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
        </ul>
    </div>
</div>
'''
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.find_all(name='ul'))
print(type(soup.find_all(name='ul')[0]))
```
è¿è¡Œç»“æœï¼š
```python
[<ul class="list" id="list-1">
<li class="element">Foo</li>
<li class="element">Bar</li>
<li class="element">Jay</li>
</ul>, <ul class="list list-small" id="list-2">
<li class="element">Foo</li>
<li class="element">Bar</li>
</ul>]
<class 'bs4.element.Tag'>
```

è¿™é‡Œæˆ‘ä»¬è°ƒç”¨äº† find_all æ–¹æ³•ï¼Œä¼ å…¥ name å‚æ•°ï¼Œå…¶å‚æ•°å€¼ä¸º ulã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æƒ³è¦æŸ¥è¯¢æ‰€æœ‰ ul èŠ‚ç‚¹ï¼Œè¿”å›ç»“æœæ˜¯åˆ—è¡¨ç±»å‹ï¼Œé•¿åº¦ä¸º 2ï¼Œæ¯ä¸ªå…ƒç´ ä¾ç„¶éƒ½æ˜¯ bs4.element.Tag ç±»å‹ã€‚

å› ä¸ºéƒ½æ˜¯ Tag ç±»å‹ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥è¿›è¡ŒåµŒå¥—æŸ¥è¯¢ã€‚è¿˜æ˜¯åŒæ ·çš„æ–‡æœ¬ï¼Œè¿™é‡ŒæŸ¥è¯¢å‡ºæ‰€æœ‰ ul èŠ‚ç‚¹åï¼Œå†ç»§ç»­æŸ¥è¯¢å…¶å†…éƒ¨çš„ li èŠ‚ç‚¹ï¼š


```python
for ul in soup.find_all(name='ul'):
    print(ul.find_all(name='li'))
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```python
[<li class="element">Foo</li>, <li class="element">Bar</li>, <li class="element">Jay</li>]
[<li class="element">Foo</li>, <li class="element">Bar</li>]
```

è¿”å›ç»“æœæ˜¯åˆ—è¡¨ç±»å‹ï¼Œåˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´ ä¾ç„¶è¿˜æ˜¯ Tag ç±»å‹ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥éå†æ¯ä¸ª li è·å–å®ƒçš„æ–‡æœ¬äº†ã€‚

```python
for ul in soup.find_all(name='ul'):
    print(ul.find_all(name='li'))
    for li in ul.find_all(name='li'):
        print(li.string)
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```html
[<li class="element">Foo</li>, <li class="element">Bar</li>, <li class="element">Jay</li>]
Foo
Bar
Jay
[<li class="element">Foo</li>, <li class="element">Bar</li>]
Foo
Bar
```

##### attrs

é™¤äº†æ ¹æ®èŠ‚ç‚¹åæŸ¥è¯¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€äº›å±æ€§æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå®ä¾‹æ„Ÿå—ä¸€ä¸‹ï¼š

```python
html='''
<div class="panel">
    <div class="panel-heading">
        <h4>Hello</h4>
    </div>
    <div class="panel-body">
        <ul class="list" id="list-1" name="elements">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
            <li class="element">Jay</li>
        </ul>
        <ul class="list list-small" id="list-2">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
        </ul>
    </div>
</div>
'''
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.find_all(attrs={'id': 'list-1'}))
print(soup.find_all(attrs={'name': 'elements'}))
```
è¿è¡Œç»“æœï¼š
```html
[<ul class="list" id="list-1" name="elements">
<li class="element">Foo</li>
<li class="element">Bar</li>
<li class="element">Jay</li>
</ul>]
[<ul class="list" id="list-1" name="elements">
<li class="element">Foo</li>
<li class="element">Bar</li>
<li class="element">Jay</li>
</ul>]
```

è¿™é‡ŒæŸ¥è¯¢çš„æ—¶å€™ä¼ å…¥çš„æ˜¯ attrs å‚æ•°ï¼Œå‚æ•°çš„ç±»å‹æ˜¯å­—å…¸ç±»å‹ã€‚æ¯”å¦‚ï¼Œè¦æŸ¥è¯¢ id ä¸º list-1 çš„èŠ‚ç‚¹ï¼Œå¯ä»¥ä¼ å…¥ attrs={'id': 'list-1'} çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¾—åˆ°çš„ç»“æœæ˜¯åˆ—è¡¨å½¢å¼ï¼ŒåŒ…å«çš„å†…å®¹å°±æ˜¯ç¬¦åˆ id ä¸º list-1 çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¦åˆæ¡ä»¶çš„å…ƒç´ ä¸ªæ•°æ˜¯ 1ï¼Œæ‰€ä»¥ç»“æœæ˜¯é•¿åº¦ä¸º 1 çš„åˆ—è¡¨ã€‚

å¯¹äºä¸€äº›å¸¸ç”¨çš„å±æ€§ï¼Œæ¯”å¦‚ id å’Œ class ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ attrs æ¥ä¼ é€’ã€‚æ¯”å¦‚ï¼Œè¦æŸ¥è¯¢ id ä¸º list-1 çš„èŠ‚ç‚¹ï¼Œå¯ä»¥ç›´æ¥ä¼ å…¥ id è¿™ä¸ªå‚æ•°ã€‚è¿˜æ˜¯ä¸Šé¢çš„æ–‡æœ¬ï¼Œæˆ‘ä»¬æ¢ä¸€ç§æ–¹å¼æ¥æŸ¥è¯¢ï¼š


```python
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.find_all(id='list-1'))
print(soup.find_all(class_='element'))
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```python
[<ul class="list" id="list-1">
<li class="element">Foo</li>
<li class="element">Bar</li>
<li class="element">Jay</li>
</ul>]
[<li class="element">Foo</li>, <li class="element">Bar</li>, <li class="element">Jay</li>, <li class="element">Foo</li>, <li class="element">Bar</li>]
```

è¿™é‡Œç›´æ¥ä¼ å…¥ id='list-1'ï¼Œå°±å¯ä»¥æŸ¥è¯¢ id ä¸º list-1 çš„èŠ‚ç‚¹å…ƒç´ äº†ã€‚è€Œå¯¹äº class æ¥è¯´ï¼Œç”±äº class åœ¨ Python é‡Œæ˜¯ä¸€ä¸ªå…³é”®å­—ï¼Œæ‰€ä»¥åé¢éœ€è¦åŠ ä¸€ä¸ªä¸‹åˆ’çº¿ï¼Œå³ class_='element'ï¼Œè¿”å›çš„ç»“æœä¾ç„¶è¿˜æ˜¯ Tag ç»„æˆçš„åˆ—è¡¨ã€‚

##### text

text å‚æ•°å¯ç”¨æ¥åŒ¹é…èŠ‚ç‚¹çš„æ–‡æœ¬ï¼Œä¼ å…¥çš„å½¢å¼å¯ä»¥æ˜¯å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
import re
html='''
<div class="panel">
    <div class="panel-body">
        <a>Hello, this is a link</a>
        <a>Hello, this is a link, too</a>
    </div>
</div>
'''
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.find_all(text=re.compile('link')))
```
è¿è¡Œç»“æœï¼š
```python
['Hello, this is a link', 'Hello, this is a link, too']
```

è¿™é‡Œæœ‰ä¸¤ä¸ª a èŠ‚ç‚¹ï¼Œå…¶å†…éƒ¨åŒ…å«æ–‡æœ¬ä¿¡æ¯ã€‚è¿™é‡Œåœ¨ find_all() æ–¹æ³•ä¸­ä¼ å…¥ text å‚æ•°ï¼Œè¯¥å‚æ•°ä¸ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œç»“æœè¿”å›æ‰€æœ‰åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼çš„èŠ‚ç‚¹æ–‡æœ¬ç»„æˆçš„åˆ—è¡¨ã€‚

#### find

é™¤äº† find_all æ–¹æ³•ï¼Œè¿˜æœ‰ find æ–¹æ³•ï¼Œåªä¸è¿‡ find æ–¹æ³•è¿”å›çš„æ˜¯å•ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…çš„å…ƒç´ ï¼Œè€Œ find_all è¿”å›çš„æ˜¯æ‰€æœ‰åŒ¹é…çš„å…ƒç´ ç»„æˆçš„åˆ—è¡¨ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
html='''
<div class="panel">
    <div class="panel-heading">
        <h4>Hello</h4>
    </div>
    <div class="panel-body">
        <ul class="list" id="list-1">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
            <li class="element">Jay</li>
        </ul>
        <ul class="list list-small" id="list-2">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
        </ul>
    </div>
</div>
'''
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
print(soup.find(name='ul'))
print(type(soup.find(name='ul')))
print(soup.find(class_='list'))
```
è¿è¡Œç»“æœï¼š
```
<ul class="list" id="list-1">
<li class="element">Foo</li>
<li class="element">Bar</li>
<li class="element">Jay</li>
</ul>
<class 'bs4.element.Tag'>
<ul class="list" id="list-1">
<li class="element">Foo</li>
<li class="element">Bar</li>
<li class="element">Jay</li>
</ul>
```

è¿”å›ç»“æœä¸å†æ˜¯åˆ—è¡¨å½¢å¼ï¼Œè€Œæ˜¯ç¬¬ä¸€ä¸ªåŒ¹é…çš„èŠ‚ç‚¹å…ƒç´ ï¼Œç±»å‹ä¾ç„¶æ˜¯ Tag ç±»å‹ã€‚

å¦å¤–è¿˜æœ‰è®¸å¤šçš„æŸ¥è¯¢æ–¹æ³•ï¼Œç”¨æ³•ä¸å‰é¢ä»‹ç»çš„ find_allã€find æ–¹æ³•å®Œå…¨ç›¸åŒï¼Œåªä¸è¿‡æŸ¥è¯¢èŒƒå›´ä¸åŒï¼Œåœ¨æ­¤åšä¸€ä¸‹ç®€å•çš„è¯´æ˜ã€‚

find_parents å’Œ find_parentï¼šå‰è€…è¿”å›æ‰€æœ‰ç¥–å…ˆèŠ‚ç‚¹ï¼Œåè€…è¿”å›ç›´æ¥çˆ¶èŠ‚ç‚¹ã€‚

find_next_siblings å’Œ find_next_siblingï¼šå‰è€…è¿”å›åé¢æ‰€æœ‰çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œåè€…è¿”å›åé¢ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ã€‚

find_previous_siblings å’Œ find_previous_siblingï¼šå‰è€…è¿”å›å‰é¢æ‰€æœ‰çš„å…„å¼ŸèŠ‚ç‚¹ï¼Œåè€…è¿”å›å‰é¢ç¬¬ä¸€ä¸ªå…„å¼ŸèŠ‚ç‚¹ã€‚

find_all_next å’Œ find_nextï¼šå‰è€…è¿”å›èŠ‚ç‚¹åæ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ï¼Œåè€…è¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ã€‚

find_all_previous å’Œ find_previousï¼šå‰è€…è¿”å›èŠ‚ç‚¹å‰æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ï¼Œåè€…è¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹ã€‚

### 7. CSS é€‰æ‹©å™¨  --.select

Beautiful Soup è¿˜æä¾›äº†å¦å¤–ä¸€ç§é€‰æ‹©å™¨ï¼Œé‚£å°±æ˜¯ CSS é€‰æ‹©å™¨ã€‚å¦‚æœå¯¹ Web å¼€å‘ç†Ÿæ‚‰çš„è¯ï¼Œé‚£ä¹ˆå¯¹ CSS é€‰æ‹©å™¨è‚¯å®šä¹Ÿä¸é™Œç”Ÿã€‚å¦‚æœä¸ç†Ÿæ‚‰çš„è¯ï¼Œå¯ä»¥å‚è€ƒ [http://www.w3school.com.cn/cssref/css_selectors.asp](http://www.w3school.com.cn/cssref/css_selectors.asp) äº†è§£ã€‚

ä½¿ç”¨ CSS é€‰æ‹©å™¨ï¼Œåªéœ€è¦è°ƒç”¨ select æ–¹æ³•ï¼Œä¼ å…¥ç›¸åº”çš„ CSS é€‰æ‹©å™¨å³å¯ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå®ä¾‹æ¥æ„Ÿå—ä¸€ä¸‹ï¼š

```python
html='''
<div class="panel">
    <div class="panel-heading">
        <h4>Hello</h4>
    </div>
    <div class="panel-body">
        <ul class="list" id="list-1">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
            <li class="element">Jay</li>
        </ul>
        <ul class="list list-small" id="list-2">
            <li class="element">Foo</li>
            <li class="element">Bar</li>
        </ul>
    </div>
</div>
'''
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
#panelé‡Œé¢çš„panel-heading
print(soup.select('.panel .panel-heading'))
print(soup.select('ul li'))
#å¹²å˜›è¿™é‡Œè¦#
print(soup.select('#list-2 .element'))
print(type(soup.select('ul')[0]))
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```python
[<div class="panel-heading">
<h4>Hello</h4>
</div>]
[<li class="element">Foo</li>, <li class="element">Bar</li>, <li class="element">Jay</li>, <li class="element">Foo</li>, <li class="element">Bar</li>]
[<li class="element">Foo</li>, <li class="element">Bar</li>]
<class 'bs4.element.Tag'>
```

è¿™é‡Œæˆ‘ä»¬ç”¨äº† 3 æ¬¡ CSS é€‰æ‹©å™¨ï¼Œè¿”å›çš„ç»“æœå‡æ˜¯ç¬¦åˆ CSS é€‰æ‹©å™¨çš„èŠ‚ç‚¹ç»„æˆçš„åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼Œ**select('ul li') åˆ™æ˜¯é€‰æ‹©æ‰€æœ‰ ul èŠ‚ç‚¹ä¸‹é¢çš„æ‰€æœ‰ li èŠ‚ç‚¹**ï¼Œç»“æœä¾¿æ˜¯æ‰€æœ‰çš„ li èŠ‚ç‚¹ç»„æˆçš„åˆ—è¡¨ã€‚ã€å¹²å˜›ä¸ç›´æ¥liğŸ¤”ã€‘

æœ€åä¸€å¥æˆ‘ä»¬æ‰“å°è¾“å‡ºäº†åˆ—è¡¨ä¸­å…ƒç´ çš„ç±»å‹ï¼Œå¯ä»¥çœ‹åˆ°ç±»å‹ä¾ç„¶æ˜¯ Tag ç±»å‹ã€‚

#### åµŒå¥—é€‰æ‹©

select æ–¹æ³•åŒæ ·æ”¯æŒåµŒå¥—é€‰æ‹©ï¼Œä¾‹å¦‚æˆ‘ä»¬å…ˆé€‰æ‹©æ‰€æœ‰ ul èŠ‚ç‚¹ï¼Œå†éå†æ¯ä¸ª ul èŠ‚ç‚¹é€‰æ‹©å…¶ li èŠ‚ç‚¹ï¼Œæ ·ä¾‹å¦‚ä¸‹ï¼š

```python
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
for ul in soup.select('ul'):
    print(ul.select('li'))
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```python
[<li class="element">Foo</li>, <li class="element">Bar</li>, <li class="element">Jay</li>]
[<li class="element">Foo</li>, <li class="element">Bar</li>]
```

å¯ä»¥çœ‹åˆ°æ­£å¸¸è¾“å‡ºäº†éå†æ¯ä¸ª ul èŠ‚ç‚¹ä¹‹åï¼Œå…¶ä¸‹çš„æ‰€æœ‰ li èŠ‚ç‚¹ç»„æˆçš„åˆ—è¡¨ã€‚

#### è·å–å±æ€§

æˆ‘ä»¬çŸ¥é“èŠ‚ç‚¹ç±»å‹æ˜¯ Tag ç±»å‹ï¼Œæ‰€ä»¥è·å–å±æ€§è¿˜å¯ä»¥ç”¨åŸæ¥çš„æ–¹æ³•ã€‚ä»ç„¶æ˜¯ä¸Šé¢çš„ HTML æ–‡æœ¬ï¼Œè¿™é‡Œå°è¯•è·å–æ¯ä¸ª ul èŠ‚ç‚¹çš„ id å±æ€§ï¼š

```python
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
for ul in soup.select('ul'):
    print(ul['id'])
    print(ul.attrs['id'])
```
è¿è¡Œç»“æœå¦‚ä¸‹ï¼š
```
list-1
list-1
list-2
list-2
```

å¯ä»¥çœ‹åˆ°ç›´æ¥ä¼ å…¥ä¸­æ‹¬å·å’Œå±æ€§åå’Œé€šè¿‡ attrs å±æ€§è·å–å±æ€§å€¼éƒ½æ˜¯å¯ä»¥æˆåŠŸçš„ã€‚

#### è·å–æ–‡æœ¬

è¦è·å–æ–‡æœ¬ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å‰é¢æ‰€è®²çš„ string å±æ€§ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£å°±æ˜¯ get_textï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š

```python
from bs4 import BeautifulSoup
soup = BeautifulSoup(html, 'lxml')
for li in soup.select('li'):
    print('Get Text:', li.get_text())
    print('String:', li.string)
```
è¿è¡Œç»“æœï¼š
```python
Get Text: Foo
String: Foo
Get Text: Bar
String: Bar
Get Text: Jay
String: Jay
Get Text: Foo
String: Foo
Get Text: Bar
String: Bar
```

äºŒè€…çš„æ•ˆæœæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œéƒ½å¯ä»¥è·å–åˆ°èŠ‚ç‚¹çš„æ–‡æœ¬å€¼ã€‚

### 8. ç»“è¯­

åˆ°æ­¤ BeautifulSoup çš„ä½¿ç”¨ä»‹ç»åŸºæœ¬å°±ç»“æŸäº†ï¼Œæœ€ååšä¸€ä¸‹ç®€å•çš„æ€»ç»“ï¼š
* æ¨èä½¿ç”¨ LXML è§£æåº“ï¼Œå¿…è¦æ—¶ä½¿ç”¨ html.parserã€‚
* èŠ‚ç‚¹é€‰æ‹©ç­›é€‰åŠŸèƒ½å¼±ä½†æ˜¯é€Ÿåº¦å¿«ã€‚
* å»ºè®®ä½¿ç”¨ findã€find_all æ–¹æ³•æŸ¥è¯¢åŒ¹é…å•ä¸ªç»“æœæˆ–è€…å¤šä¸ªç»“æœã€‚
* å¦‚æœå¯¹ CSS é€‰æ‹©å™¨ç†Ÿæ‚‰çš„è¯å¯ä»¥ä½¿ç”¨ select é€‰æ‹©æ³•ã€‚
